from OpenSSL import crypto
from pwn import xor

cert_pem =xor( b"G_ab!bb_oR_oss_o",bytes.fromhex("6a724c4f0c202718261c7f2c36210b260116222375274f72427f72653e3a1629291b22216056331c2e031e18372206250c303b2b491401112e031a2131221e1820052c1a621823152d3511393132063b06340d376c3027282b25062b79250e3e0e1b200a700335091b306d5a43290b2a0a12200d6623530a2a10281837200a1717123327562615062b040e3e38371e07173d260e4b0735150331352a2b79122d1218205374272128181d3c02250406370d6f0352450a3b32033b0602180b1905060a23056f34201e221f1b3b36091215242a035059123b6c033b05373a0b55273d1e052046091337043b185604431d2c161a362766060a06023e36361e4a1e0d7527113b120e0b05371b28271b1011222d16162c752b18122b176e2119226f651037022c6c082b28210616153e371a5e092524527608211d04281a233e323428066e3427630a2f1c3c040e1736271e3f05382f34632305122c141d1f29246e194d3d0f304d2f33281811383637250e3e0f1b202c6b36276717170b2e23313821111d200d6c2127661c330821462a32393e123301562433062b040e3e3f371e5a3e553b3a630a01313d240d5d351a3e380d36003664352f1d3e151e5e26361e1830112c366c182c265a243d281f193a380d33020864042f1d5f151c3c02340c26256c6b267027281e3d0b0e354135360e101508001120143d283e350a2439330c2d1c2223482b151b3e0b15241c291607313c2f237027201d3e131b08143a0f2e031c226860050d1c0835162d32382f18031a020e4a062e2b271015393b222b03062d2452791104701602174437261208366c31126e31566d1c2829591e103c1d2f7433502b0516123a391c40370a151912683438420c1530561b6b240644093a2a15324d455b340602021540041a303d1429595015272f07566b3e26430770383e0a28255968186e5c052a0a1b031617131d530a6b0e053d043038091d356d1d2b19594d770e3626077d3924294538040b2b0c0717570c660a236c041e433b150a3e3737774d68250c31102d20183903171955294f03513d3b262b2c260a1a5e683d0d324a2d356607001a5e46091a362513062c5435176b2a7d2b0d1d402822130d110d720535553c0b34021c05110372144a0c6c5a163b3a0a3b3f050708390e07562f6c0b1217171e662d16437415370c2827554d180d04040d404b05180d70360d126d280b1e652470570b1a3e1b053703014310303a0c3f694418360b37221b150f18380118231c3b3605380759103450120a2a53330310703d091b3505316e10201137262d0858313f295c14266c6d25076e49112c071d2b5c1d18141b72281b17464d3a1b3d67161e050a3d2d0970361b4c1a252e583f743d4b2a2f0631371124682d20125e3d554034052500290523184f0330671b3a672b58012a2977100b304a08366d371f38010619252a350c002b7b5737162d1a36381d022e01116b3b37510c3867250712654b3a071c051e0e5751531b05170b36073a11331c1f08521717381538001d3b1f3432703e043b1805443714250a3708031c053b0872283751400a53352e18302b792037010c6c0f527850242e5c6b2c081f01330a120e5917140e090e0327391a17346f083f163b2b57060d6736601339151f1d350c090c17765325170d11110a3b796c1673255829703210295b646b1610170e2a2b062c33442b283c2265703831057039752505144c2b03142c026f3a26263e2d750f20056c20231e2a251b3e2a3955242805280a57012c1e3e17112d22321b082016232368152b0d0a22691c2519740d3f101910162f1b3a2464182d4512163b250810375054056d07171d2329393465252e3b327857096f362b700d14026a5a22134a5b690d283b0d1739192625152d2c39380d493805262331181c4b350b3e351c550e7707212e010b69211b3d32404d692d384f2b113e0816091d0a442704173d0b166c13521757210a011d3d3c207f062b346b00491b0e7d0e03360a3722343c3b5770552f26371005291d34173c055518125313142a3e2208292909673a1429301a5010213d061830003b251615012f590f12492a153f350a05303e3a0a2509541269181a39193e690b1b453b0e6c106b23540c0115171f061e4a223b352e0c3b32165105260c7d373607121b3b0b122f2f19305a3d5f346e404419265a161a2e147823242a1a13690a0012135b0b2608686f3630681c03290d32253e241f082036162b363105196f08012b1709166d513b542c162a06356d020b422e271628111a68343313580b6d0c301d2706212a03292b5a3a151b2b3719063f2d1b2b13051276081a7403312a5809413e0d043c1b28533a2731201e155a3124313d1f0d28507849570a16056f0d120a3a0b346e58096e68016958603c081746140b743b2e0b62572c1c1b053956193e1203222d111073171a0e2c0b1e5f1c0b3859051120056a2d12385d1c272d114a17212e6e103046066828587d7008031b3b0e13264e2a16363a323f1c053f25003538231d310077101532560216191f246e2d2d3d4e326f2035343a036f1a3e470f0530330a1263282355051c1715042b1236000b382d6923091839016956091b1b267e2d345a4c060411183b0a1706243b282a3c5353450d291c5e7d2a4411382719706a54497b2f550c653a071b113237293e6c081078291a0d3537145a1f10703a286931316000536e2c34142b04462e2001320e24420e3a1c57270e07271b34440b08093547140b30565872425e5e722a091b412164303616291b1c2e273672426a724c68"))
working_c = crypto.load_certificate(crypto.FILETYPE_PEM,cert_pem)

cert = crypto.X509()
sub = cert.get_subject()
sub_w = working_c.get_subject()
sub.C = sub_w.C
sub.ST = sub_w.ST
sub.L = sub_w.L
sub.O = sub_w.O
sub.CN = sub_w.CN
sub.emailAddress = sub_w.emailAddress

cert.set_serial_number(0)
cert.set_issuer(cert.get_subject())
cert.gmtime_adj_notBefore(0)
cert.gmtime_adj_notAfter(365 * 24 * 60 * 60)

key = crypto.PKey()
key.generate_key(crypto.TYPE_RSA, 2048)

cert.set_pubkey(key)          
cert.sign(key, "sha256")  

print(xor(b"G_ab!bb_oR_oss_o",crypto.dump_certificate(crypto.FILETYPE_PEM,cert)).hex())